apiVersion: v1
kind: Service
metadata:
  namespace: {{namespace}}
  name: {{app}}
  labels:
    tier: {{tier}}
    environment: {{environment}}
    app: {{app}}
    branch: {{branch}}
    project: {{app}}
    team: {{namespace}}
spec:
  selector:
    app: {{app}}
  ports:
  - port: {{targetPort}}
    protocol: TCP
    targetPort: {{targetPort}}

---

apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  namespace: {{namespace}}
  name: {{app}}
  labels:
    app: {{app}}
    project: {{app}}
    team: {{namespace}}
spec:
  replicas: {{replicas}}
  template:
    metadata:
      labels:
        app: {{app}}
    spec:
      containers:
      - name: {{app}}
        image: {{registry}}.visual-meta.com/{{app}}/{{app}}:{{tag}}
        ports:
        - containerPort: {{targetPort}}
